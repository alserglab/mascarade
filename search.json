[{"path":"https://alserglab.github.io/mascarade/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Alexey Sergushichev Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-gallery.html","id":"loading-necessary-libraries","dir":"Articles","previous_headings":"","what":"Loading necessary libraries","title":"Gallery of mascarade-generaded masks","text":"","code":"library(mascarade) library(data.table) library(ggplot2) library(ggsci)"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-gallery.html","id":"pbmc-3k-umap","dir":"Articles","previous_headings":"","what":"PBMC-3K UMAP","title":"Gallery of mascarade-generaded masks","text":"","code":"example <- readRDS(url(\"https://alserglab.wustl.edu/files/mascarade/examples/pbmc3k_umap.rds\")) data <- data.table(example$dims,                     cluster=example$clusters)  maskTable <- generateMask(dims=example$dims,                            clusters=example$clusters)  ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(aes(color=cluster)) +      geom_path(data=maskTable, aes(group=group)) +     coord_fixed() +      theme_classic()"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-gallery.html","id":"pbmc-3k-t-sne","dir":"Articles","previous_headings":"","what":"PBMC-3K t-SNE","title":"Gallery of mascarade-generaded masks","text":"","code":"example <- readRDS(url(\"https://alserglab.wustl.edu/files/mascarade/examples/pbmc3k_tsne.rds\")) data <- data.table(example$dims,                     cluster=example$clusters)  maskTable <- generateMask(dims=example$dims,                            clusters=example$clusters)  ggplot(data, aes(x=tSNE_1, y=tSNE_2)) +      geom_point(aes(color=cluster)) +      geom_path(data=maskTable, aes(group=group)) +     coord_fixed() +      theme_classic()"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-gallery.html","id":"aya","dir":"Articles","previous_headings":"","what":"Aya","title":"Gallery of mascarade-generaded masks","text":"","code":"example <- readRDS(url(\"https://alserglab.wustl.edu/files/mascarade/examples/aya.rds\")) data <- data.table(example$dims,                     cluster=example$clusters)  maskTable <- generateMask(dims=example$dims,                            clusters=example$clusters)  ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(aes(color=cluster), size=0.5) +      geom_path(data=maskTable, aes(group=group)) +     coord_fixed() +      theme_classic()"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-gallery.html","id":"chia-jung","dir":"Articles","previous_headings":"","what":"Chia-Jung","title":"Gallery of mascarade-generaded masks","text":"","code":"example <- readRDS(url(\"https://alserglab.wustl.edu/files/mascarade/examples/chiajung1.rds\")) data <- data.table(example$dims,                     cluster=example$clusters)  maskTable <- generateMask(dims=example$dims,                            clusters=example$clusters)  ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(aes(color=cluster), size=0.1) +      scale_color_ucscgb() +     geom_path(data=maskTable, aes(group=group)) +     coord_fixed() +      theme_classic() example <- readRDS(url(\"https://alserglab.wustl.edu/files/mascarade/examples/chiajung2.rds\")) data <- data.table(example$dims,                     cluster=example$clusters)  maskTable <- generateMask(dims=example$dims,                            clusters=example$clusters)  ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(aes(color=cluster)) +      geom_path(data=maskTable, aes(group=group)) +     coord_fixed() +      theme_classic()"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-gallery.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Gallery of mascarade-generaded masks","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.3 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] ggsci_4.2.0        ggplot2_4.0.1      data.table_1.18.0  mascarade_0.2.9001 ##  ## loaded via a namespace (and not attached): ##  [1] sass_0.4.10            generics_0.1.4         spatstat.explore_3.6-0 ##  [4] tensor_1.5.1           spatstat.data_3.1-9    lattice_0.22-7         ##  [7] digest_0.6.39          magrittr_2.0.4         spatstat.utils_3.2-0   ## [10] evaluate_1.0.5         grid_4.5.2             RColorBrewer_1.1-3     ## [13] fastmap_1.2.0          jsonlite_2.0.0         Matrix_1.7-4           ## [16] spatstat.sparse_3.1-0  scales_1.4.0           tweenr_2.0.3           ## [19] textshaping_1.0.4      jquerylib_0.1.4        abind_1.4-8            ## [22] cli_3.6.5              rlang_1.1.6            polyclip_1.10-7        ## [25] withr_3.0.2            cachem_1.1.0           yaml_2.3.12            ## [28] otel_0.2.0             spatstat.univar_3.1-5  tools_4.5.2            ## [31] deldir_2.0-4           dplyr_1.1.4            spatstat.geom_3.6-1    ## [34] vctrs_0.6.5            R6_2.6.1               lifecycle_1.0.4        ## [37] fs_1.6.6               htmlwidgets_1.6.4      MASS_7.3-65            ## [40] ragg_1.5.0             pkgconfig_2.0.3        desc_1.4.3             ## [43] pkgdown_2.2.0          pillar_1.11.1          bslib_0.9.0            ## [46] gtable_0.3.6           glue_1.8.0             ggforce_0.5.0          ## [49] systemfonts_1.3.1      xfun_0.55              tibble_3.3.0           ## [52] tidyselect_1.2.1       knitr_1.51             goftest_1.2-3          ## [55] farver_2.1.2           nlme_3.1-168           spatstat.random_3.4-3  ## [58] htmltools_0.5.9        labeling_0.4.3         rmarkdown_2.30         ## [61] compiler_4.5.2         S7_0.2.1"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-tutorial.html","id":"package-installation","dir":"Articles","previous_headings":"","what":"Package installation","title":"Using mascarade package","text":"recent version package can installed GitHub:","code":"remotes::install_github(\"alserglab/mascarade\")"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-tutorial.html","id":"loading-necessary-libraries","dir":"Articles","previous_headings":"","what":"Loading necessary libraries","title":"Using mascarade package","text":"","code":"library(mascarade) library(data.table) library(ggplot2) library(ggforce)"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-tutorial.html","id":"example-run","dir":"Articles","previous_headings":"","what":"Example run","title":"Using mascarade package","text":"Loading example data PBMC 3K processed Seurat (see details). UMAP coordinates: Cluster annotations: Expression table several genes: Let’s plot data:  Now let’s generate cluster masks: maskTable actually table cluster borders. single cluster can multiple connected parts, one single part can contain multiple border lines (groups). Now can use table draw borders geom_path (group column used group aesthetics):  can color borders instead points:  can use ggforce package make borders touch instead overlap:  presence small clusters can help expand borders bit away points.  help ggforce-based function geom_mark_shape can also put labels within plot .  can achived fancyMask() helper function:  Now can easily show association cell types expression particular genes, GNLY good marker NK cells dataset.  can focus single cluster :","code":"data(\"exampleMascarade\") head(exampleMascarade$dims) ##                   UMAP_1    UMAP_2 ## AAACATACAACCAC -4.232792 -4.152139 ## AAACATTGAGCTAC -4.892886 10.985685 ## AAACATTGATCAGC -5.508639 -7.211088 ## AAACCGTGCTTCCG 11.332233  3.161727 ## AAACCGTGTATGCG -7.450703  1.092022 ## AAACGCACTGGTAC -3.509504 -6.087042 head(exampleMascarade$clusters) ## AAACATACAACCAC AAACATTGAGCTAC AAACATTGATCAGC AAACCGTGCTTCCG AAACCGTGTATGCG  ##   Memory CD4 T              B   Memory CD4 T     CD14+ Mono             NK  ## AAACGCACTGGTAC  ##   Memory CD4 T  ## 9 Levels: Naive CD4 T Memory CD4 T CD14+ Mono B CD8 T FCGR3A+ Mono NK ... Platelet head(exampleMascarade$features) ##                     MS4A1       GNLY       CD3E      CD14     FCER1A     FCGR3A ## AAACATACAACCAC -0.4110536 -0.4081782  1.0157094 -0.393789 -0.1373491 -0.4507969 ## AAACATTGAGCTAC  2.5965712 -0.4081782 -0.9189074 -0.393789 -0.1373491 -0.4507969 ## AAACATTGATCAGC -0.4110536  0.7526607  0.8148764 -0.393789 -0.1373491 -0.4507969 ## AAACCGTGCTTCCG -0.4110536 -0.4081782 -0.9189074 -0.393789 -0.1373491  1.1300704 ## AAACCGTGTATGCG -0.4110536  2.3958265 -0.9189074 -0.393789 -0.1373491 -0.4507969 ## AAACGCACTGGTAC -0.4110536 -0.4081782  1.1029222 -0.393789 -0.1373491 -0.4507969 ##                        LYZ       PPBP       CD8A ## AAACATACAACCAC -0.11104505 -0.1416271  2.1039769 ## AAACATTGAGCTAC  0.06112027 -0.1416271 -0.3537211 ## AAACATTGATCAGC  0.07833934 -0.1416271 -0.3537211 ## AAACCGTGCTTCCG  1.40875149  2.9255239 -0.3537211 ## AAACCGTGTATGCG -0.97272094 -0.1416271 -0.3537211 ## AAACGCACTGGTAC -0.06309661 -0.1416271 -0.3537211 data <- data.table(exampleMascarade$dims,                     cluster=exampleMascarade$clusters,                    exampleMascarade$features) ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(aes(color=cluster)) +      coord_fixed() +      theme_classic() maskTable <- generateMask(dims=exampleMascarade$dims,                            clusters=exampleMascarade$clusters) head(maskTable) ##       UMAP_1    UMAP_2           part            group      cluster ##        <num>     <num>         <char>           <char>       <fctr> ## 1: -3.980324 -9.021239 Memory CD4 T#1 Memory CD4 T#1#1 Memory CD4 T ## 2: -3.945936 -9.009776 Memory CD4 T#1 Memory CD4 T#1#1 Memory CD4 T ## 3: -3.934473 -8.998313 Memory CD4 T#1 Memory CD4 T#1#1 Memory CD4 T ## 4: -3.923011 -8.986850 Memory CD4 T#1 Memory CD4 T#1#1 Memory CD4 T ## 5: -3.911548 -8.975387 Memory CD4 T#1 Memory CD4 T#1#1 Memory CD4 T ## 6: -3.900085 -8.963925 Memory CD4 T#1 Memory CD4 T#1#1 Memory CD4 T ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(aes(color=cluster)) +      geom_path(data=maskTable, aes(group=group)) +     coord_fixed() +      theme_classic() ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(color=\"grey\") +      geom_path(data=maskTable, aes(group=group, color=cluster), linewidth=1) +     coord_fixed() +      theme_classic() ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(color=\"grey\") +      ggforce::geom_shape(data=maskTable, aes(group=group, color=cluster),                         linewidth=1, fill=NA, expand=unit(-1, \"pt\")) +     coord_fixed() +      theme_classic() maskTable <- generateMask(dims=exampleMascarade$dims,                            clusters=exampleMascarade$clusters,                           expand=0.02) ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(color=\"grey\") +      ggforce::geom_shape(data=maskTable, aes(group=group, color=cluster),                         linewidth=1, fill=NA, expand=unit(-1, \"pt\")) +     coord_fixed() +      theme_classic() myMask <- list(     geom_mark_shape(data=maskTable, aes(group=cluster, color=cluster, label = cluster),                     fill = NA,                    linewidth=1, expand=unit(-1, \"pt\"),                    con.cap=0, con.type = \"straight\",                    label.fontsize = 10, label.buffer = unit(0, \"cm\"),                    label.fontface = \"plain\",                    label.minwidth = 0,                    label.margin = margin(2, 2, 2, 2, \"pt\"),                    label.lineheight = 0,                    con.colour = \"inherit\",                    show.legend = FALSE),     # expanding to give a bit more space for labels     scale_x_continuous(expand = expansion(mult = 0.1)),     scale_y_continuous(expand = expansion(mult = 0.1)) )  ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +     geom_point(color=\"grey\") +     myMask +     coord_fixed() +     theme_classic() ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +     geom_point(color=\"grey\") +     fancyMask(maskTable, ratio=1) +     theme_classic() ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(aes(color=GNLY), size=0.5) +     scale_color_gradient2(low = \"#404040\", high=\"red\") +      fancyMask(maskTable, ratio=1) +     theme_classic() ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +      geom_point(aes(color=GNLY), size=0.5) +      scale_color_gradient2(low = \"#404040\", high=\"red\") +      geom_path(data=maskTable[cluster==\"NK\"], aes(group=group)) +     coord_fixed() +      theme_classic()"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-tutorial.html","id":"working-with-seurat","dir":"Articles","previous_headings":"","what":"Working with Seurat","title":"Using mascarade package","text":"part vignette need Seuratpackage. Let’s get example PBMC3K dataset: object can obtained using SeuratData package (can installed remotes::install_github('satijalab/seurat-data')): Generate masks using helper function: can use fancyMask() now:  DimPlot, borders can viewed redundant removed:  Let’s plot NK cell marker:  multiple markers (skipping labels save space):  Works t-SNE :","code":"library(Seurat) pbmc3k <- readRDS(url(\"https://alserglab.wustl.edu/files/mascarade/examples/pbmc3k_seurat5.rds\")) pbmc3k <- NormalizeData(pbmc3k) pbmc3k ## An object of class Seurat  ## 13714 features across 2638 samples within 1 assay  ## Active assay: RNA (13714 features, 2000 variable features) ##  2 layers present: counts, data ##  2 dimensional reductions calculated: pca, umap if (requireNamespace(\"SeuratData\")) {     if (!AvailableData()[\"pbmc3k\", \"Installed\"]) {         InstallData(\"pbmc3k\")         }     LoadData(\"pbmc3k\")          pbmc3k <- UpdateSeuratObject(pbmc3k.final)         pbmc3k } maskTable <- generateMaskSeurat(pbmc3k) DimPlot(pbmc3k) + NoLegend() +     fancyMask(maskTable, ratio=1) DimPlot(pbmc3k) + NoLegend() +     fancyMask(maskTable, linewidth = 0, ratio=1) FeaturePlot(pbmc3k, \"GNLY\", cols=c(\"grey90\", \"red\")) +     fancyMask(maskTable, ratio=1) featureList <- c(\"MS4A1\", \"GNLY\", \"CD3E\", \"CD14\") plots <- FeaturePlot(pbmc3k, features=featureList, cols=c(\"grey90\", \"red\"), combine = FALSE) plots <- lapply(plots, `+`, fancyMask(maskTable, ratio=1, linewidth=0.5, label=FALSE)) patchwork::wrap_plots(plots) pbmc3k <- RunTSNE(pbmc3k)  maskTable <- generateMaskSeurat(pbmc3k, reduction = \"tsne\")  plots <- FeaturePlot(pbmc3k,                       features=featureList,                      reduction = \"tsne\",                      cols=c(\"grey90\", \"red\"),                      combine = FALSE) plots <- lapply(plots, `+`, fancyMask(maskTable, ratio=1, linewidth=0.5, label=FALSE))  patchwork::wrap_plots(plots)"},{"path":"https://alserglab.github.io/mascarade/articles/mascarade-tutorial.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Using mascarade package","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.3 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] Seurat_5.4.0       SeuratObject_5.3.0 sp_2.2-0           ggforce_0.5.0      ## [5] ggplot2_4.0.1      data.table_1.18.0  mascarade_0.2.9001 ##  ## loaded via a namespace (and not attached): ##   [1] pbapply_1.7-4          deldir_2.0-4           gridExtra_2.3          ##   [4] rlang_1.1.6            magrittr_2.0.4         RcppAnnoy_0.0.22       ##   [7] otel_0.2.0             matrixStats_1.5.0      ggridges_0.5.7         ##  [10] compiler_4.5.2         spatstat.geom_3.6-1    reshape2_1.4.5         ##  [13] png_0.1-8              systemfonts_1.3.1      vctrs_0.6.5            ##  [16] stringr_1.6.0          pkgconfig_2.0.3        fastmap_1.2.0          ##  [19] labeling_0.4.3         promises_1.5.0         rmarkdown_2.30         ##  [22] ragg_1.5.0             purrr_1.2.0            xfun_0.55              ##  [25] cachem_1.1.0           jsonlite_2.0.0         goftest_1.2-3          ##  [28] later_1.4.4            spatstat.utils_3.2-0   tweenr_2.0.3           ##  [31] irlba_2.3.5.1          parallel_4.5.2         cluster_2.1.8.1        ##  [34] R6_2.6.1               ica_1.0-3              stringi_1.8.7          ##  [37] bslib_0.9.0            RColorBrewer_1.1-3     spatstat.data_3.1-9    ##  [40] reticulate_1.44.1      parallelly_1.46.0      spatstat.univar_3.1-5  ##  [43] scattermore_1.2        lmtest_0.9-40          jquerylib_0.1.4        ##  [46] Rcpp_1.1.0             knitr_1.51             tensor_1.5.1           ##  [49] future.apply_1.20.1    zoo_1.8-15             sctransform_0.4.2      ##  [52] httpuv_1.6.16          Matrix_1.7-4           splines_4.5.2          ##  [55] igraph_2.2.1           tidyselect_1.2.1       abind_1.4-8            ##  [58] yaml_2.3.12            codetools_0.2-20       spatstat.random_3.4-3  ##  [61] miniUI_0.1.2           spatstat.explore_3.6-0 listenv_0.10.0         ##  [64] plyr_1.8.9             lattice_0.22-7         tibble_3.3.0           ##  [67] shiny_1.12.1           withr_3.0.2            S7_0.2.1               ##  [70] ROCR_1.0-11            evaluate_1.0.5         Rtsne_0.17             ##  [73] future_1.68.0          fastDummies_1.7.5      desc_1.4.3             ##  [76] survival_3.8-3         polyclip_1.10-7        fitdistrplus_1.2-4     ##  [79] pillar_1.11.1          KernSmooth_2.23-26     plotly_4.11.0          ##  [82] generics_0.1.4         RcppHNSW_0.6.0         scales_1.4.0           ##  [85] xtable_1.8-4           globals_0.18.0         glue_1.8.0             ##  [88] lazyeval_0.2.2         tools_4.5.2            RSpectra_0.16-2        ##  [91] RANN_2.6.2             fs_1.6.6               dotCall64_1.2          ##  [94] cowplot_1.2.0          grid_4.5.2             tidyr_1.3.2            ##  [97] patchwork_1.3.2        nlme_3.1-168           cli_3.6.5              ## [100] spatstat.sparse_3.1-0  textshaping_1.0.4      spam_2.11-1            ## [103] viridisLite_0.4.2      dplyr_1.1.4            uwot_0.2.4             ## [106] gtable_0.3.6           sass_0.4.10            digest_0.6.39          ## [109] progressr_0.18.0       ggrepel_0.9.6          htmlwidgets_1.6.4      ## [112] farver_2.1.2           htmltools_0.5.9        pkgdown_2.2.0          ## [115] lifecycle_1.0.4        httr_1.4.7             mime_0.13              ## [118] MASS_7.3-65"},{"path":"https://alserglab.github.io/mascarade/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Alexey Sergushichev. Author, maintainer.","code":""},{"path":"https://alserglab.github.io/mascarade/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sergushichev (2026). mascarade: Generating Cluster Masks Single-Cell Dimensional Reduction Plots. R package version 0.2.9001, https://alserglab.github.io/mascarade/.","code":"@Manual{,   title = {mascarade: Generating Cluster Masks for Single-Cell Dimensional Reduction Plots},   author = {Alexey Sergushichev},   year = {2026},   note = {R package version 0.2.9001},   url = {https://alserglab.github.io/mascarade/}, }"},{"path":"https://alserglab.github.io/mascarade/index.html","id":"mascarade","dir":"","previous_headings":"","what":"Generating Cluster Masks for Single-Cell Dimensional Reduction Plots","title":"Generating Cluster Masks for Single-Cell Dimensional Reduction Plots","text":"mascarade package implements procedure automatically generate 2D masks clusters single-cell dimensional reduction plots like t-SNE UMAP. See tutorial usage details gallery examples different datasets.","code":""},{"path":"https://alserglab.github.io/mascarade/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Generating Cluster Masks for Single-Cell Dimensional Reduction Plots","text":"package can installed GitHub:","code":"remotes::install_github(\"alserglab/mascarade\")"},{"path":"https://alserglab.github.io/mascarade/index.html","id":"quick-run","dir":"","previous_headings":"","what":"Quick run","title":"Generating Cluster Masks for Single-Cell Dimensional Reduction Plots","text":"Loading necessary libraries: Loading get example PBMC3K dataset: Generating masks: DimPlot mask labels:  DimPlot just labels  FeaturePlot mask labels showing GNLY gene specific NK cells:","code":"library(mascarade) library(ggplot2) library(data.table) library(Seurat) pbmc3k <- readRDS(url(\"https://alserglab.wustl.edu/files/mascarade/examples/pbmc3k_seurat5.rds\")) pbmc3k <- NormalizeData(pbmc3k) pbmc3k ## An object of class Seurat  ## 13714 features across 2638 samples within 1 assay  ## Active assay: RNA (13714 features, 2000 variable features) ##  2 layers present: counts, data ##  2 dimensional reductions calculated: pca, umap maskTable <- generateMaskSeurat(pbmc3k) DimPlot(pbmc3k) + NoLegend() +     fancyMask(maskTable, ratio=1) DimPlot(pbmc3k) + NoLegend() +     fancyMask(maskTable, linewidth=0, ratio=1) FeaturePlot(pbmc3k, \"GNLY\", cols=c(\"grey90\", \"red\")) +     fancyMask(maskTable, ratio=1)"},{"path":"https://alserglab.github.io/mascarade/reference/exampleMascarade.html","id":null,"dir":"Reference","previous_headings":"","what":"Example data with UMAP points from PBMC3K dataset. — exampleMascarade","title":"Example data with UMAP points from PBMC3K dataset. — exampleMascarade","text":"object list three elements: dims – matrix UMAP coordinates cells, clusters – vector cell population annotations, features – matrix withgene expression several genes.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/fancyMask.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate ggplot2 layers for a labeled cluster mask — fancyMask","title":"Generate ggplot2 layers for a labeled cluster mask — fancyMask","text":"Convenience helper returns list ggplot2 components draws polygon-like outlines places cluster labels. plotting limits expanded (via limits.expand) provide extra room labels.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/fancyMask.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate ggplot2 layers for a labeled cluster mask — fancyMask","text":"","code":"fancyMask(   maskTable,   ratio = NULL,   limits.expand = ifelse(label, 0.1, 0.05),   linewidth = 1,   shape.expand = linewidth * unit(-1, \"pt\"),   label = TRUE,   label.fontsize = 10,   label.buffer = unit(0, \"cm\"),   label.fontface = \"plain\",   label.margin = margin(2, 2, 2, 2, \"pt\") )"},{"path":"https://alserglab.github.io/mascarade/reference/fancyMask.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate ggplot2 layers for a labeled cluster mask — fancyMask","text":"maskTable data.frame mask coordinates. first two columns interpreted x/y coordinates (order). Must contain least columns cluster (factor) group (grouping identifier passed geom_mark_shape()). ratio Optional aspect ratio passed ggplot2::coord_cartesian(). Use 1 equal scaling. Default NULL (fixed ratio). limits.expand Numeric scalar giving fraction x/y range expand sides setting plot limits. Default 0.1 labels 0.05 labels. linewidth Line width passed geom_mark_shape() outline. Default 1. shape.expand Expansion contraction applied marked shapes, passed geom_mark_shape(expand = ...). Default unit(-linewidth, \"pt\"). label Boolean flag wheter labels displayed. label.fontsize Label font size passed geom_mark_shape(). Default 10. label.buffer Label buffer distance passed geom_mark_shape(). Default unit(0, \"cm\"). label.fontface Label font face passed geom_mark_shape(). Default \"plain\". label.margin Label margin passed geom_mark_shape(). Default margin(2, 2, 2, 2, \"pt\").","code":""},{"path":"https://alserglab.github.io/mascarade/reference/fancyMask.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate ggplot2 layers for a labeled cluster mask — fancyMask","text":"list ggplot2 components suitable adding plot +, containing: ggplot2::coord_cartesian() specification, geom_mark_shape() layer.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/fancyMask.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate ggplot2 layers for a labeled cluster mask — fancyMask","text":"first two columns maskTable used x/y coordinates. Cluster labels taken maskTable$cluster. Shapes grouped maskTable$group.","code":""},{"path":[]},{"path":"https://alserglab.github.io/mascarade/reference/fancyMask.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate ggplot2 layers for a labeled cluster mask — fancyMask","text":"","code":"data(\"exampleMascarade\") maskTable <- generateMask(dims=exampleMascarade$dims,                           clusters=exampleMascarade$clusters) library(ggplot2) ggplot(do.call(cbind, exampleMascarade)) +     geom_point(aes(x=UMAP_1, y=UMAP_2, color=GNLY)) +     fancyMask(maskTable, ratio=1) +     theme_classic()"},{"path":"https://alserglab.github.io/mascarade/reference/generateMask.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate mask for clusters on 2D dimensional reduction plots — generateMask","title":"Generate mask for clusters on 2D dimensional reduction plots — generateMask","text":"Internally function rasterizes smoothes density plots.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/generateMask.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate mask for clusters on 2D dimensional reduction plots — generateMask","text":"","code":"generateMask(   dims,   clusters,   gridSize = 200,   expand = 0.005,   minDensity = lifecycle::deprecated(),   smoothSigma = NA,   minSize = 10,   kernel = lifecycle::deprecated(),   type = lifecycle::deprecated() )"},{"path":"https://alserglab.github.io/mascarade/reference/generateMask.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate mask for clusters on 2D dimensional reduction plots — generateMask","text":"dims matrix point coordinates. Rows points, columns dimensions. first two columns used. clusters vector cluster annotations. length number rows dims. gridSize target width height raster used internally expand distance used expand borders, represented fraction sqrt(width*height). Default: 1/200. minDensity Deprecated. anything. smoothSigma Deprecated. Parameter controlling smoothing joining close cells groups, represented fraction sqrt(width*height). Increasing parameter can help dealing sparse regions. minSize Groups less minSize points ignored, unless group cluster kernel Deprecated. anything. type Deprecated. anything.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/generateMask.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate mask for clusters on 2D dimensional reduction plots — generateMask","text":"data.table points representing mask borders. individual border line corresponds single level group column. Cluster assignment cluster column.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/generateMask.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate mask for clusters on 2D dimensional reduction plots — generateMask","text":"","code":"data(\"exampleMascarade\") maskTable <- generateMask(dims=exampleMascarade$dims,                           clusters=exampleMascarade$clusters) data <- data.frame(exampleMascarade$dims,                    cluster=exampleMascarade$clusters,                    exampleMascarade$features) library(ggplot2) ggplot(data, aes(x=UMAP_1, y=UMAP_2)) +     geom_point(aes(color=cluster)) +     geom_path(data=maskTable, aes(group=group)) +     coord_fixed() +     theme_classic()"},{"path":"https://alserglab.github.io/mascarade/reference/generateMaskSeurat.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates mask from a Seurat object. Requires SeuratObject package. — generateMaskSeurat","title":"Generates mask from a Seurat object. Requires SeuratObject package. — generateMaskSeurat","text":"Generates mask Seurat object. Requires SeuratObject package.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/generateMaskSeurat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates mask from a Seurat object. Requires SeuratObject package. — generateMaskSeurat","text":"","code":"generateMaskSeurat(   object,   reduction = NULL,   group.by = NULL,   gridSize = 200,   expand = 0.005,   minSize = 10 )"},{"path":"https://alserglab.github.io/mascarade/reference/generateMaskSeurat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates mask from a Seurat object. Requires SeuratObject package. — generateMaskSeurat","text":"object Seurat object reduction character vector specifying reduction use (default: DefaultDimReduc(object)) group.character vector specifying field use clusters (default: \"ident\") gridSize target width height raster used internally expand distance used expand borders, represented fraction sqrt(width*height). Default: 1/200. minSize Groups less minSize points ignored, unless group cluster","code":""},{"path":"https://alserglab.github.io/mascarade/reference/generateMaskSeurat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates mask from a Seurat object. Requires SeuratObject package. — generateMaskSeurat","text":"data.table points representing mask borders. individual border line corresponds single level group column. Cluster assignment cluster column.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/generateMaskSeurat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generates mask from a Seurat object. Requires SeuratObject package. — generateMaskSeurat","text":"","code":"# only run if Seurat is installed if (require(\"Seurat\")) {     data(\"pbmc_small\")     maskTable <- generateMaskSeurat(pbmc_small)      library(ggplot2)     # not the best plot, see vignettes for better examples     DimPlot(pbmc_small) +         geom_path(data=maskTable, aes(x=tSNE_1, y=tSNE_2, group=group)) } #> Loading required package: Seurat #> Loading required package: SeuratObject #> Loading required package: sp #>  #> Attaching package: ‘SeuratObject’ #> The following objects are masked from ‘package:base’: #>  #>     intersect, t"},{"path":"https://alserglab.github.io/mascarade/reference/geom_mark_shape.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate areas with polygonal shapes — geom_mark_shape","title":"Annotate areas with polygonal shapes — geom_mark_shape","text":"geom lets annotate sets points via polygonal shapes. Unlike ggforce::geom_mark_* functions, geom_mark_shape explicitly provided shape coordinates. ggforce::geom_shape, polygon can expanded/contracted corners can rounded, controlled expand radius parameters.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/geom_mark_shape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate areas with polygonal shapes — geom_mark_shape","text":"","code":"geom_mark_shape(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   expand = 0,   radius = 0,   label.margin = margin(2, 2, 2, 2, \"mm\"),   label.width = NULL,   label.minwidth = unit(50, \"mm\"),   label.hjust = 0,   label.fontsize = 12,   label.family = \"\",   label.lineheight = 1,   label.fontface = c(\"bold\", \"plain\"),   label.fill = \"white\",   label.colour = \"black\",   label.buffer = unit(10, \"mm\"),   con.colour = \"black\",   con.size = 0.5,   con.type = \"elbow\",   con.linetype = 1,   con.border = \"one\",   con.cap = unit(3, \"mm\"),   con.arrow = NULL,   ...,   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"https://alserglab.github.io/mascarade/reference/geom_mark_shape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate areas with polygonal shapes — geom_mark_shape","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. expand numeric unit vector length one, specifying expansion amount. Negative values result contraction instead. value given numeric understood proportion plot area width. radius expand specifying corner radius. label.margin margin around annotation boxes, given call ggplot2::margin(). label.width fixed width label. Set NULL let text label.minwidth decide. label.minwidth minimum width provide description. size label exceeds , description allowed fill much label. label.hjust horizontal justification annotation. contains two elements first used label second description. label.fontsize size text annotation. contains two elements first used label second description. label.family font family used annotation. contains two elements first used label second description. label.lineheight height line multipler fontsize. contains two elements first used label second description. label.fontface font face used annotation. contains two elements first used label second description. label.fill fill colour annotation box. Use \"inherit\" use fill enclosure \"inherit_col\" use border colour enclosure. label.colour text colour annotation. contains two elements first used label second description. Use \"inherit\" use border colour enclosure \"inherit_fill\" use fill colour enclosure. label.buffer size region around mark labels placed. con.colour colour line connecting annotation mark. Use \"inherit\" use border colour enclosure \"inherit_fill\" use fill colour enclosure. con.size width connector. Use \"inherit\" use border width enclosure. con.type type connector. Either \"elbow\", \"straight\", \"none\". con.linetype linetype connector. Use \"inherit\" use border linetype enclosure. con.border bordertype connector. Either \"one\" (draw line horizontal side closest mark), \"\" (draw border sides), \"none\" (going explain one). con.cap distance mark line stop . con.arrow arrow specification connection using grid::arrow() end pointing towards mark. ... arguments passed layer()'s params argument. arguments broadly fall one 4 categories . Notably, arguments position argument, aesthetics required can passed .... Unknown arguments part 4 categories ignored. Static aesthetics mapped scale, fixed value apply layer whole. example, colour = \"red\" linewidth = 3. geom's documentation Aesthetics section lists available options. 'required' aesthetics passed params. Please note passing unmapped aesthetics vectors technically possible, order required length guaranteed parallel input data. constructing layer using stat_*() function, ... argument can used pass parameters geom part layer. example stat_density(geom = \"area\", outline.type = \"\"). geom's documentation lists parameters can accept. Inversely, constructing layer using geom_*() function, ... argument can used pass parameters stat part layer. example geom_area(stat = \"density\", adjust = 0.5). stat's documentation lists parameters can accept. key_glyph argument layer() may also passed .... can one functions described key glyphs, change display layer legend. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. borders().","code":""},{"path":"https://alserglab.github.io/mascarade/reference/geom_mark_shape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate areas with polygonal shapes — geom_mark_shape","text":"ggplot2 layer (ggplot2::layer) adds polygonal shape annotations plot.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/geom_mark_shape.html","id":"aesthetics","dir":"Reference","previous_headings":"","what":"Aesthetics","title":"Annotate areas with polygonal shapes — geom_mark_shape","text":"geom_mark_shape understand following aesthetics (required aesthetics bold): x y x0 (used anchor label) y0 (used anchor label) filter label description color fill group size linetype alpha","code":""},{"path":"https://alserglab.github.io/mascarade/reference/geom_mark_shape.html","id":"annotation","dir":"Reference","previous_headings":"","what":"Annotation","title":"Annotate areas with polygonal shapes — geom_mark_shape","text":"geom_mark_* allow put descriptive textboxes connected mark plot, using label description aesthetics. textboxes automatically placed close mark, without obscuring datapoints layer. placement dynamic resize plot see annotation might move around areas become big enough small fit annotation. enough space annotation without overlapping data get drawn. cases try resizing plot, change size annotation, decrease buffer region around marks.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/geom_mark_shape.html","id":"filtering","dir":"Reference","previous_headings":"","what":"Filtering","title":"Annotate areas with polygonal shapes — geom_mark_shape","text":"Often marks used draw attention , annotate specific features plot thus desirable marks around everything. possible simply pre-filter data used mark layer, geom_mark_* geoms also comes dedicated filter aesthetic , set, remove rows evalutates FALSE. multiple benefits using instead prefiltering. First, change data source, making code adaptable exploration. Second, data removed filter aesthetic remembered geom, annotation take care overlap removed data.","code":""},{"path":"https://alserglab.github.io/mascarade/reference/geom_mark_shape.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate areas with polygonal shapes — geom_mark_shape","text":"","code":"library(ggplot2) shape1 <- data.frame(     x = c(0, 3, 3, 2, 2, 1, 1, 0),     y = c(0, 0, 3, 3, 1, 1, 3, 3), label=\"bracket\" ) shape2 <- data.frame(     x = c(0, 3, 3, 0)+4,     y = c(0, 0, 3, 3),     label=\"square\" ) shape3 <- data.frame(     x = c(0, 1.5, 3, 1.5)+8,     y = c(1.5, 0, 1.5, 3),     label=\"diamond\" )  ggplot(rbind(shape1, shape2, shape3), aes(x=x, y=y, label=label, color=label, fill=label)) +     geom_mark_shape() +     ylim(0, 5)"},{"path":"https://alserglab.github.io/mascarade/news/index.html","id":"mascarade-030","dir":"Changelog","previous_headings":"","what":"mascarade 0.3.0","title":"mascarade 0.3.0","text":"Significant performance improvements Introduced generateMaskSeurat() fancyMask() helper functions.","code":""},{"path":"https://alserglab.github.io/mascarade/news/index.html","id":"mascarade-020","dir":"Changelog","previous_headings":"","what":"mascarade 0.2.0","title":"mascarade 0.2.0","text":"Major rewrite generateMask function, change interface","code":""}]
